var Url=function(){var l={protocol:"protocol",host:"hostname",port:"port",path:"pathname",query:"search",hash:"hash"},m={ftp:21,gopher:70,http:80,https:443,ws:80,wss:443},p=function(a,g){var d=document,b=d.createElement("a");g=g||d.location.href;var c=g.match(/\/\/(.*?)(?::(.*?))?@/)||[],f;b.href=g;for(f in l)a[f]=b[l[f]]||"";a.protocol=a.protocol.replace(/:$/,"");a.query=a.query.replace(/^\?/,"");a.hash=h(a.hash.replace(/^#/,""));a.user=h(c[1]||"");a.pass=h(c[2]||"");a.port=m[a.protocol]==a.port||0==a.port?"":a.port;if(a.protocol||/^([a-z]+:)?\/\//.test(g))a.path=a.path.replace(/^\/?/,"/");else{var d=new Url(d.location.href.match(/(.*\/)/)[0]),b=d.path.split("/"),c=a.path.split("/"),k=["protocol","user","pass","host","port"],e=k.length;b.pop();for(f=0;f<e;f++)a[k[f]]=d[k[f]];for(;".."==c[0];)b.pop(),c.shift();a.path=("/"!=g.charAt(0)?b.join("/"):"")+"/"+c.join("/")}a.paths(("/"==a.path.charAt(0)?a.path.slice(1):a.path).split("/"));n(a)},e=function(a){return encodeURIComponent(a).replace(/'/g,"%27")},h=function(a){a=a.replace(/\+/g," ");a=a.replace(/%([ef][0-9a-f])%([89ab][0-9a-f])%([89ab][0-9a-f])/gi,function(a,d,b,c){d=parseInt(d,16)-224;b=parseInt(b,16)-128;if(0==d&&32>b)return a;c=parseInt(c,16)-128;c=(d<<12)+(b<<6)+c;return 65535<c?a:String.fromCharCode(c)});a=a.replace(/%([cd][0-9a-f])%([89ab][0-9a-f])/gi,function(a,d,b){d=parseInt(d,16)-192;if(2>d)return a;a=parseInt(b,16)-128;return String.fromCharCode((d<<6)+a)});return a=a.replace(/%([0-7][0-9a-f])/gi,function(a,d){return String.fromCharCode(parseInt(d,16))})},n=function(a){a.query=new function(a){for(var d=/([^=&]+)(=([^&]*))?/g,b;b=d.exec(a);){var c=decodeURIComponent(b[1].replace(/\+/g," "));b=b[3]?h(b[3]):"";null!=this[c]?(this[c]instanceof Array||(this[c]=[this[c]]),this[c].push(b)):this[c]=b}this.clear=function(){for(var a in this)this[a]instanceof Function||delete this[a]};this.count=function(){var a=0,b;for(b in this)this[b]instanceof Function||a++;return a};this.isEmpty=function(){return 0===this.count()};this.toString=function(){var a="",b,c;for(b in this)if(!(this[b]instanceof Function))if(this[b]instanceof Array){var d=this[b].length;if(d)for(c=0;c<d;c++)a+=a?"&":"",a+=e(b)+"="+e(this[b][c]);else a+=(a?"&":"")+e(b)+"="}else a+=a?"&":"",a+=e(b)+"="+e(this[b]);return a}}(a.query)};return function(a){this.paths=function(a){var d="",b=0,c;if(a&&a.length&&a+""!==a){this.isAbsolute()&&(d="/");for(c=a.length;b<c;b++)a[b]=e(a[b]);this.path=d+a.join("/")}a=("/"===this.path.charAt(0)?this.path.slice(1):this.path).split("/");b=0;for(c=a.length;b<c;b++)a[b]=h(a[b]);return a};this.encode=e;this.decode=h;this.isAbsolute=function(){return this.protocol||"/"===this.path.charAt(0)};this.toString=function(){return(this.protocol&&this.protocol+"://")+(this.user&&e(this.user)+(this.pass&&":"+e(this.pass))+"@")+(this.host&&this.host)+(this.port&&":"+this.port)+(this.path&&this.path)+(this.query.toString()&&"?"+this.query)+(this.hash&&"#"+e(this.hash))};this.toRelativeString=function(){return(this.path&&this.path)+(this.query.toString()&&"?"+this.query)+(this.hash&&"#"+e(this.hash))};p(this,a)}}();